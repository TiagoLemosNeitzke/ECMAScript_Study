<html>

<body>

    <script>
        let processoAssincrono = new Promise((resolve, reject) => {
            setTimeout(() => {
                resolve("Sucesso! Processo assíncrono")
            }, 3000)
        })

        /*
        Usando o async antes da palavra reservada function eu indico que esta function deve aguardar o retorno de um processo para depois seguir para o próximo.

        Preciso add await nos processos que eu quero que seja aguardado o retorno
        
        
        */

        async function recuperaDados() {
            await processoAssincrono.then(retorno => {
                console.log(retorno)
            })

            console.log('outro processo assíncrono!')

            await fetch('https://jsonplaceholder.typicode.com/posts')
                .then(response => response.json())
                .then(retorno => {
                    console.log(retorno)
                })

            fetch('https://jsonplaceholder.typicode.com/comments')
                .then(response => response.json())
                .then(retorno => {
                    console.log(retorno)
                })
            return 'retorno'
        }

        recuperaDados().then( p => 
            console.log('Fim', p)
        )
    </script>
    
</body>

</html>